<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>Cards Filtering & אלגוריתמיקה</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      margin: 20px;
    }
    h2, h3 {
      margin-bottom: 10px;
    }
    /* סגנון לתפריט העליון */
    #menu {
      margin-bottom: 20px;
    }
    #menu select,
    #menu input,
    #menu button {
      margin-right: 10px;
      margin-bottom: 10px;
      padding: 5px 10px;
      font-size: 1rem;
    }
    /* סגנון לכרטיסיות */
    #cardsContainer {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .card {
      border: 1px solid #ccc;
      padding: 10px;
      width: 200px;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
      border-radius: 4px;
    }
    .card p {
      margin: 5px 0;
      font-size: 0.9rem;
    }
    /* סגנון לחלק האלגוריתמיקה */
    #palindromeSection,
    #cipherSection {
      margin-bottom: 20px;
    }
    #palindromeSection input,
    #cipherSection input,
    #cipherSection button {
      margin-right: 10px;
      padding: 5px 10px;
      font-size: 1rem;
    }
    #cipherResult {
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- חלק הכרטיסיות וסינון -->
  <section id="cardsSection">
    <h2>סינון והצגת כרטיסיות</h2>
    <div id="menu">
      <select id="fieldSelect">
        <option value="age">Age</option>
        <option value="name">Name</option>
        <option value="admin">Admin</option>
        <option value="grades">Grades</option>
        <option value="address">Address</option>
      </select>
      <input type="text" id="filterInput" placeholder="הזן ערך">
      <button id="findBtn">Find</button>
      <button id="allGradesBtn">Than Greater Grades All</button>
      <button id="someGradesBtn">Than Greater Grades Some</button>
      <button id="manipulateBtn">Manipulation And Filter Array</button>
    </div>
    <div id="cardsContainer"></div>
  </section>

  <hr>

  <script>
    // מערך הנתונים (יש להעתיקו לפרוייקט)
    const data = [
      { age: 25, name: "Alice", admin: true, grades: [90, 85, 92], address: { city: "ashdod", houseNumber: 50 } },
      { age: 30, name: "Bob", admin: false, grades: [70, 75, 80], address: { city: "tel aviv", houseNumber: 30 } },
      { age: 20, name: "Charlie", admin: true, grades: [95, 90, 93], address: { city: "ashdod", houseNumber: 60 } },
      { age: 18, name: "David", admin: false, grades: [50, 55, 60], address: { city: "haifa", houseNumber: 20 } },
      { age: 22, name: "Eva", admin: true, grades: [88, 89, 91], address: { city: "tel aviv", houseNumber: 40 } },
      { age: 28, name: "Frank", admin: false, grades: [65, 70, 72], address: { city: "ashdod", houseNumber: 55 } },
      { age: 35, name: "Grace", admin: true, grades: [92, 93, 94], address: { city: "haifa", houseNumber: 35 } },
      { age: 40, name: "Hannah", admin: false, grades: [80, 82, 78], address: { city: "tel aviv", houseNumber: 45 } },
      { age: 27, name: "Ivan", admin: true, grades: [85, 87, 90], address: { city: "ashdod", houseNumber: 65 } },
      { age: 19, name: "Julia", admin: false, grades: [60, 62, 65], address: { city: "haifa", houseNumber: 25 } }
    ];

    // פונקציה להצגת כרטיסיות
    function renderCards(cards) {
      const container = document.getElementById('cardsContainer');
      container.innerHTML = '';
      if (cards.length === 0) {
        container.innerHTML = '<p>לא נמצאו תוצאות</p>';
        return;
      }
      cards.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <p><strong>Name:</strong> ${item.name}</p>
          <p><strong>Age:</strong> ${item.age}</p>
          <p><strong>Admin:</strong> ${item.admin}</p>
          <p><strong>Grades:</strong> ${item.grades.join(', ')}</p>
          <p><strong>Address:</strong> ${item.address.city}, House #${item.address.houseNumber}</p>
        `;
        container.appendChild(card);
      });
    }

    // הצגת כל הכרטיסיות בהתחלה
    renderCards(data);

    // כפתור Find – סינון לפי שדה נבחר והערך שהוזן
    document.getElementById('findBtn').addEventListener('click', function(){
      const field = document.getElementById('fieldSelect').value;
      const filterVal = document.getElementById('filterInput').value.trim();
      let filtered = [];
      
      if(field === 'age'){
        const num = parseFloat(filterVal);
        filtered = data.filter(item => item.age > num);
      } else if(field === 'name'){
        filtered = data.filter(item => item.name.toLowerCase().includes(filterVal.toLowerCase()));
      } else if(field === 'admin'){
        if(filterVal.toLowerCase() === "true"){
          filtered = data.filter(item => item.admin === true);
        } else if(filterVal.toLowerCase() === "false"){
          filtered = data.filter(item => item.admin === false);
        }
      } else if(field === 'grades'){
        const num = parseFloat(filterVal);
        filtered = data.filter(item => {
          const avg = item.grades.reduce((a, b) => a + b, 0) / item.grades.length;
          return avg > num;
        });
      } else if(field === 'address'){
        // פורמט הצפוי: value.fieldname לדוגמה: city.ashdod
        const parts = filterVal.split('.');
        if(parts.length === 2) {
          const [fieldName, value] = parts;
          filtered = data.filter(item => {
            if(item.address && item.address[fieldName]) {
              return item.address[fieldName].toString().toLowerCase() === value.toLowerCase();
            }
            return false;
          });
        }
      }
      renderCards(filtered);
    });

    // כפתור "Than Greater Grades All" - כל הציונים > הערך שהוזן
    document.getElementById('allGradesBtn').addEventListener('click', function(){
      const filterVal = parseFloat(document.getElementById('filterInput').value.trim());
      const filtered = data.filter(item => item.grades.every(grade => grade > filterVal));
      renderCards(filtered);
    });

    // כפתור "Than Greater Grades Some" - לפחות ציון אחד > הערך שהוזן
    document.getElementById('someGradesBtn').addEventListener('click', function(){
      const filterVal = parseFloat(document.getElementById('filterInput').value.trim());
      const filtered = data.filter(item => item.grades.some(grade => grade > filterVal));
      renderCards(filtered);
    });

    // כפתור "Manipulation And Filter Array"
    // מסנן לפי: ממוצע ציונים < הערך וה-houseNumber > הערך, ובמידה ועומד בתנאי – מוסיף את הערך לגיל.
    document.getElementById('manipulateBtn').addEventListener('click', function(){
      const inputVal = parseFloat(document.getElementById('filterInput').value.trim());
      const filtered = data.filter(item => {
        const avg = item.grades.reduce((a, b) => a + b, 0) / item.grades.length;
        return avg < inputVal && item.address.houseNumber > inputVal;
      }).map(item => {
        // עדכון הגיל
        return { ...item, age: item.age + inputVal };
      });
      renderCards(filtered);
    });

    // חלק האלגוריתמיקה
    // בדיקת Palindrome - שינוי צבע הרקע של השדה
    document.getElementById('checkPalindromeBtn').addEventListener('click', function(){
      const str = document.getElementById('palindromeInput').value.trim();
      const normalized = str.toLowerCase().replace(/[\W_]/g, '');
      const reversed = normalized.split('').reverse().join('');
      if(normalized && normalized === reversed) {
        document.getElementById('palindromeInput').style.backgroundColor = 'lightgreen';
      } else {
        document.getElementById('palindromeInput').style.backgroundColor = 'lightcoral';
      }
    });

    // פונקציה להצפנה ופענוח (קיסר)
    function caesarCipher(str, shift, encrypt = true) {
      return str.split('').map(char => {
        if(char.match(/[a-z]/i)) {
          const code = char.charCodeAt(0);
          const base = (code >= 65 && code <= 90) ? 65 : 97;
          if(encrypt) {
            return String.fromCharCode(((code - base + shift) % 26) + base);
          } else {
            return String.fromCharCode(((code - base - shift + 26) % 26) + base);
          }
        }
        return char;
      }).join('');
    }

    // כפתור Encrypt
    document.getElementById('encryptBtn').addEventListener('click', function(){
      const text = document.getElementById('cipherText').value;
      const shift = parseInt(document.getElementById('shiftNumber').value, 10);
      if(isNaN(shift)) {
        alert('הזן מספר תקין עבור השיפט.');
        return;
      }
      const encrypted = caesarCipher(text, shift, true);
      document.getElementById('cipherResult').textContent = 'Encrypted: ' + encrypted;
    });

    // כפתור Decrypt
    document.getElementById('decryptBtn').addEventListener('click', function(){
      const text = document.getElementById('cipherText').value;
      const shift = parseInt(document.getElementById('shiftNumber').value, 10);
      if(isNaN(shift)) {
        alert('הזן מספר תקין עבור השיפט.');
        return;
      }
      const decrypted = caesarCipher(text, shift, false);
      document.getElementById('cipherResult').textContent = 'Decrypted: ' + decrypted;
    });
  </script>
</body>
</html>